# Урок 1. Знакомство с Flask

## Classwork

### Теория:

#### Что такое Flask?

Flask — это микрофреймворк для Python, созданный
в 2010 году разработчиком по имени Армин
Ронахер. Пристава «микро» говорит о том, что Flask
действительно маленький. У него в комплекте нет
ни набора инструментов, ни библиотек, которыми
славятся другие популярные фреймворки. Но он
создан с потенциалом для расширения. Во
фреймворке есть набор базовых возможностей, а
расширения отвечают за все остальное. «Чистый»
Flask не умеет подключаться к базе данных,
проверять данные формы и так далее. Для
добавления этих функций нужно использовать
расширения. Это помогает использовать только те из
них, которые на самом деле нужны.

#### Установка Flask и обязательных компонентов

Создаём виртуальное окружение и запускаем pip install Flask
Фреймворки Flask и FastAPI
● Werkzeug — набор инструментов WSGI, стандартного интерфейса Python для развёртывания вебприложений и взаимодействия
между ними и различными серверами разработки. Отвечает за роутинг,
обработку запросов и ответов, а также предоставляет такие возможности, как debugger и reloader.
● Jinja2 — движок шаблонов и одновременно современный язык шаблонов для Python, созданный по образцу
шаблонов Django. Он быстр, широко используется и безопасен, благодаря дополнительной среде отрисовки
шаблона в песочнице.
● Click — фреймворк для написания приложений командной строки. Он предоставляет консольную команду
flask и позволяет добавлять пользовательские команды управления.
● MarkupSafe поставляется с Jinja. MarkupSafe исключает ненадежный ввод при рендеринге шаблонов, чтобы
избежать атак путем внедрения нежелательного кода.
● itsDangerous - дополнение, которое подписывает данные для обеспечения их целостности. Он используется
для защиты cookie файлов в сеансе Flas

#### Первое веб-приложение

Рассмотрим код в IDE
Первая оптимизация
Создаём wsgi.py
Первый проект
Первый запуск
flask --app
lesson_1/project run

#### Устройство view функций

Разберём подробнее как работаю функции представления на
примерах:
Фреймворки Flask и FastAPI
@app.route('/Николай/')
def nike():
return 'Привет, Николай!'

#### Множественное декорирование

Одна функция-представление может быть декорирована
несколькими декораторами
Фреймворки Flask и FastAPI
@app.route('/Фёдор/')
@app.route('/Fedor/')
@app.route('/Федя/')
def fedor():
return 'Привет, Феодор!'

#### Прописываем логику обработки URL

Типы переменных при передаче в функцию
● string - (по умолчанию) принимает текст без слеша
● int - принимает позитивные целые числа
● float - принимает позитивные числа с плавающей точкой
● path - как string, но принимает слеши
● uuid - принимает строки UUID (универсальный уникальный идентификатор)

#### Выводим HTML

##### Многостраничный текст с тегами

@app.route('/text/')
def text():
return """<p>Вот не думал, не гадал,<br>Программистом взял и
стал.<br>Хитрый знает он язык,<br>Он к другому не привык.</p>"""

##### Рендеринг HTML файла

from flask import Flask
from flask import render_template
app = Flask(__name__)
@app.route('/index/')
def html_index():
return render_template('index.html')

#### Шаблонизатор Jinja

Пробрасываем контекст из представления в шаблон
Передать ключевые аргументы в шаблон - стандартная практика для Flask и Jinja
@app.route('/index/')
def index():
context = {
'title': 'Личный блог',
'name': 'Харитон',
}
return render_template('index.html', **context)

##### Вывод контекста в шаблоне

Помимо простой передачи {{ переменной }} можно использовать ветвления и циклы в шаблонах
Условный оператор:
{% if логика %}
значение
{% elif логика %}
значение
{% else %}
значение
{% endif %}
Цикл:
{% for item in item_list %}
{{ item }}
{% endfor %}

##### Вывод сложных структур в цикле

{% for user in users %}
<h2>{{ user.name }}</h2>
 <p>{{ user.mail }}</p>
 <p>{{ user.phone }}</p>
 {% endfor %}

#### Наследование шаблонов

Базовый и дочерние шаблоны
Дочерние шаблоны расширяют содержимое базового шаблона
Базовый шаблон
...
{% block content %}
Страница не заполнена
{% endblock %}
...
Дочерний шаблон
{% extends 'base.html' %}
{% block content %}
 <h1 class="display-2">Страница заполнена</h1>
{% endblock %}